<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carregando...</title>
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1261351159328647');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1261351159328647&ev=PageView&noscript=1"
    /></noscript>
    <script>
        (async function() {
            const CONFIG = {
                SELLER_API_KEY: "388b8789-c0f6-4cbc-ae23-fca2094372a2",
                PRESSEL_ID: 145,
                WHITE_PAGE_URL: "https://br.pinterest.com/pin/22095854406665522/",
                BOT_USERNAME: "AlineFrancaBimbot",
                API_BASE_URL: "https://novaapi-one.vercel.app"
            };
            function getQueryParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            }
            function getFacebookCookies() {
                const cookies = document.cookie.split('; ');
                let fbp = null, fbc = null;
                for (const cookie of cookies) {
                    const parts = cookie.split('=');
                    if (parts[0] === '_fbp') fbp = parts[1];
                    if (parts[0] === '_fbc') fbc = parts[1];
                }
                return { fbp, fbc };
            }
            try {
                const { fbp, fbc } = getFacebookCookies();
                const response = await fetch(CONFIG.API_BASE_URL + '/api/registerClick', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        sellerApiKey: CONFIG.SELLER_API_KEY,
                        presselId: CONFIG.PRESSEL_ID,
                        referer: document.referrer || null,
                        fbclid: getQueryParam('fbclid'),
                        fbp: fbp,
                        fbc: fbc,
                        user_agent: navigator.userAgent,
                        utm_source: getQueryParam('utm_source'),
                        utm_campaign: getQueryParam('utm_campaign'),
                        utm_medium: getQueryParam('utm_medium'),
                        utm_content: getQueryParam('utm_content'),
                        utm_term: getQueryParam('utm_term')
                    })
                });
                if (!response.ok) throw new Error('Falha ao registrar clique.');
                const { click_id } = await response.json();

                // Dispara ViewContent no Pixel da Meta
                fbq('track', 'ViewContent', {}, { eventID: click_id });

                const botUrl = `https://t.me/${CONFIG.BOT_USERNAME}?start=${click_id}`;
                window.location.href = botUrl;
            } catch (error) {
                console.error("Erro na pressel:", error);
                window.location.href = CONFIG.WHITE_PAGE_URL; // Redireciona para p√°gina branca em caso de erro
            }
        })();
    </script>
</head>
<body>
    <p>Carregando...</p>
</body>
</html>
